
import Head from 'next/head';
import styles from '../styles/modules/Headphones.module.css';

import { MongoClient } from 'mongodb';
import { ProductQkView } from '../src/components/ProductQkView';


export default function Headphones({data}) {
    //console.log(data)
    return (
        <div className={styles.page}>

	<Head>
	    <title>Headphones | Audiophile</title>
	  <meta
            name="description"
            content="Generated by create next app" />
	    <link rel="icon" href="/favicon.ico" />
	</Head>
          <section>
            <ProductQkView data={data}/>
          </section>
	</div>
    )
} 
//console.log(process.env.MONGODB_URI)
export const getStaticProps = async () => {

  const client = await MongoClient.connect(process.env.MONGODB_URI);

  const db = client.db('audiophile');

  const yourCollection = db.collection('product');

    let query = await yourCollection.find({category: "headphones",});
    let data = []
    query.forEach(entry => {
       // entry._id = entry._id.toString();
        data.push(entry)
    })

    console.log(data)

  //client.close();

  return {
      props: {
          data
      }
  };
}
